/** * Created by web on 2015/8/25. */angular.module('cmdb')    .controller('MainCtrl',['MainService', 'inc',        function (MainService, inc) {            var self = this;  // self = $scope            self.inc = inc;            MainService.get().then(function(resp){                self.projects = eval(resp.data);            });    }])    .controller('ServiceCtrl',['incc',        function(incc){            var self = this;            self.services = incc;      }])    .controller('ServiceAddCtrl',['$http', 'ServiceService', 'utils',        function($http, ServiceService, utils){            var self = this;            self.serviceFormData = {};            self.alerts = [];            self.closeAlert = function(index){                self.alerts.splice(index, 1);            };            self.serviceSubmit = function(){                $http({                    url: utils.join('service', self.service_id),                    method: "POST",                    data: self.serviceFormData                }).success(function(resp){                    self.alerts.push({                        type: 'success',                        msg: resp                    });                }).error(function(error){                    self.alerts.push({                        type: 'danger',                        msg: error                    });                });            };    }])    .controller('ProjectCtrl',        ['ProjectService', '$routeParams',        function(ProjectService,$routeParams){            var self = this;            self.projectname = $routeParams.projectName;            ProjectService.getServiceIp($routeParams.projectName).then(                function(resp){                    self.ipArray = eval(resp.data);            });    }])    .controller('ProjectDeploymentCtrl',        ['DeploymentService', '$routeParams',        function (DeploymentService, $routeParams){            var self = this;            self.projectname = $routeParams.projectName;            self.ip = $routeParams.ip;            self.range = function(n) {return new Array(n)};            DeploymentService.getDeployment(self.projectname, self.ip)                .then(function(resp) {                    self.dateArray = eval(resp.data);                    // current 目录一直指向最新的日期,就是数组的最后的一项(如果服务已排序)                    self.currentIndex = self.dateArray.length - 1;                    self.currentDate = self.dateArray[self.currentIndex];                });    }])    .controller('ProjectDeploymentDetailCtrl',        ['DeploymentService','$routeParams',        function(DeploymentService, $routeParams){            var self = this;            self.projectname = $routeParams.projectName;            DeploymentService.getDeploymentDetail(                self.projectname, $routeParams.ip, $routeParams.deployDate)                .then(function(resp){                    self.detail = angular.fromJson(resp.data)                });        }]);